{
  "build": {
    "builder": "nodejs"
  },
  "serverless": false,
  "services": [
    {
      "name": "frontend",
      "build": {
        "builder": "nodejs",
        "buildCommand": "npm run build",
        "outputDir": "dist",
        "rootDirectory": "."
      },
      "startCommand": "npm run preview",
      "ports": [
        {
          "port": 4173,
          "protocol": "http"
        }
      ],
      "env": {
        "VITE_API_BASE_URL": "${BACKEND_URL}/api",
        "NODE_ENV": "production"
      }
    },
    {
      "name": "backend",
      "build": {
        "builder": "nodejs",
        "buildCommand": "npm install",
        "rootDirectory": "."
      },
      "startCommand": "node server/simple-server.js",
      "ports": [
        {
          "port": 3007,
          "protocol": "http"
        }
      ],
      "env": {
        "NODE_ENV": "production",
        "PORT": "3007",
        "JWT_SECRET": "${JWT_SECRET}",
        "DB_HOST": "${DB_HOST}",
        "DB_USER": "${DB_USER}",
        "DB_PASSWORD": "${DB_PASSWORD}",
        "DB_NAME": "${DB_NAME}",
        "DB_PORT": "${DB_PORT}",
        "UPLOAD_DIR": "uploads",
        "FRONTEND_URL": "${FRONTEND_URL}",
        "ZEABUR_DOMAIN": "${ZEABUR_DOMAIN}",
        "MYSQL_HOST": "${DB_HOST}",
        "MYSQL_USERNAME": "${DB_USER}",
        "MYSQL_PASSWORD": "${DB_PASSWORD}",
        "MYSQL_DATABASE": "${DB_NAME}",
        "MYSQL_PORT": "${DB_PORT}"
      }
    }
  ]
}
